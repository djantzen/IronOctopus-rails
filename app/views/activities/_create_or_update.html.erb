<div class="container">
  <div id="create-update-activity-form">
    <%= form_for @activity do |form| %>
      <div class="row">
        <%= form.label :name, 'Name' %>
        <%= form.text_field :name, :class => 'required' %><br />
        <%= link_to "You can use Markdown syntax here", "http://kramdown.rubyforge.org/quickref.html", :target => '_blank' %>
        <%= form.label :instructions, "Instructions" %>
        <%= form.text_area :instructions %><br />
        <%= form.label :activity_type, "Activity Type" %>
        <%= form.select :activity_type,
                        @activity_types.map { |activity_type | [activity_type.name, activity_type.activity_type_id] },
                        :selected => @activity.activity_type.nil? ? nil : @activity.activity_type.activity_type_id %><br />
      </div>

      <div class="row">
        <div id="attribute-panel" class="ui-state-default">

          <div class="span3">
            <h3>Anatomy Involved</h3>
            <ul id="available-body-part-list" class="unstyled">
              <% group_body_parts_by_region(@body_parts).each_pair do |region, body_parts| %>
                <li>
                  <%= region %>
                </li>
                <ul class="unstyled">
                  <% body_parts.each do |body_part| %>
                    <li>
                      <%= check_box_tag "activity[body_parts][]", body_part.name, @activity.body_parts.include?(body_part) ? true : false %>
                      <%= h body_part.name %>
                    </li>
                  <% end %>
                </ul>
              <% end %>
            </ul>
          </div>

          <div class="span3">
            <h3>Implements Utilized</h3>
            <ul id="available-implement-list" class="unstyled">
              <% group_implements_by_category(@implements).each_pair do |category, implements| %>
                <li>
                  <%= category %>
                </li>
                <ul class="unstyled">
                  <% implements.each do |implement| %>
                    <li>
                      <%= check_box_tag "activity[implements][]", implement.name, @activity.implements.include?(implement) ? true : false %>
                      <%= h implement.name %>
                    </li>
                  <% end %>
                </ul>
              <% end %>
            </ul>
          </div>

          <div class="span3">
            <h3>Metrics</h3>
            <ul id="available-metric-list" class="unstyled">
              <% @metrics.each do |metric| %>
                <li>
                  <%= check_box_tag "activity[metrics][]", metric.name, @activity.metrics.include?(metric) ? true : false %>
                  <%= h metric.name %>
                </li>
              <% end %>
            </ul>
          </div>

          <div class="span3">
            <h3>Attributes</h3>
            <ul id="available-activity-attribute-list" class="unstyled">
              <% @activity_attributes.each do |attribute| %>
                <li>
                  <%= check_box_tag "activity[activity_attributes][]", attribute.name, @activity.activity_attributes.include?(attribute) ? true : false %>
                  <%= h attribute.name %>
                </li>
              <% end %>
            </ul>
          </div>

        </div>
      </div>

      <div class="row">
        <%= submit_tag "Save", :class => 'btn btn-primary' %>
        <%= link_to("Cancel", activities_path) %>
      </div>

    <% end %>
  </div>
</div>